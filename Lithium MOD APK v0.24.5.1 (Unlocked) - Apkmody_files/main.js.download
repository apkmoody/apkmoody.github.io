function ajax(data,callback){let request=new XMLHttpRequest();request.open('POST',apkmody.ajax_url);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");request.setRequestHeader("Cache-Control","no-cache, no-store, must-revalidate");request.onload=function(){if(request.status===200){if(callback){callback(request.responseText);}}};request.send(param(data));}
function param(object){var encodedString='';for(var prop in object){if(object.hasOwnProperty(prop)){if(encodedString.length>0){encodedString+='&';}
encodedString+=encodeURI(prop+'='+object[prop]);}}
return encodedString;}
function handleCredentialResponse(response){ajax({action:'login_with_google',jwt:response.credential,_wpnonce:apkmody.login_nonce,},function(response){if(response){response=JSON.parse(response);if(response.status===true){window.location.href=apkmody.refefer_url;}}});}
window.addEventListener('load',()=>{const download=document.getElementById('download');const download_loading=document.getElementById('download-loading');if(download&&download_loading){setTimeout(function(){download_loading.style.display='none';download.style.display='block';},6000);}
const download_button=document.getElementById('download-button');const downloaded_text=document.getElementById('downloaded-text');if(download_button&&downloaded_text){download_button.addEventListener('click',function(){setTimeout(function(){downloaded_text.style.display='block';downloaded_text.style.animation='fade-in 1s';},1000);});}
const open_search=document.getElementById('open-search');open_search.addEventListener('click',function(){setTimeout(function(){document.getElementById('search-input').focus();},250);});const sidenav_triggers=document.querySelectorAll('.sidenav-trigger');if(sidenav_triggers){sidenav_triggers.forEach((sidenav_trigger)=>{let current_sidenav=document.getElementById(sidenav_trigger.dataset.target);var current_sidenav_overlay=document.querySelector('.sidenav-overlay[data-target="'+current_sidenav.id+'"]');sidenav_trigger.addEventListener('click',function(){current_sidenav.classList.add('sidenav-open');current_sidenav_overlay.classList.add('sidenav-overlay-open');});current_sidenav_overlay.addEventListener('click',function(){current_sidenav.classList.remove('sidenav-open');current_sidenav_overlay.classList.remove('sidenav-overlay-open');});});}
if(window.matchMedia("(max-width: 600px)").matches){const footer_details_items=document.querySelectorAll('footer details');if(footer_details_items){footer_details_items.forEach((item)=>{item.open=false;});}}
const languages=document.getElementById('languages');if(languages){languages.addEventListener('change',function(){window.location.href=languages.options[languages.selectedIndex].value;});}
let share_button=document.getElementById('share-button');if(share_button){if(navigator.share){share_button.addEventListener('click',()=>{const canonicalLink=document.querySelector('link[rel=canonical]');const url=canonicalLink?canonicalLink.href:location.href;navigator.share({title:document.title,text:document.title,url:url,});});}else{share_button.style.display='none';}}
const noti_count=document.getElementById('notifications-count');if(noti_count){if(navigator.setAppBadge){navigator.setAppBadge(parseInt(noti_count.innerHTML));}}
const add_wishlist=document.getElementById('add-wishlist');const added_wishlist=document.getElementById('added-wishlist');if(add_wishlist&&added_wishlist){add_wishlist.addEventListener('click',function(){ajax({action:'add_to_wishlist',post_id:apkmody.post_id,_wpnonce:apkmody.nonce_add_wishlist},function(data){if(data){add_wishlist.style.display='none';added_wishlist.style.display='block';}});});added_wishlist.addEventListener('click',function(){ajax({action:'remove_from_wishlist',post_id:apkmody.post_id,_wpnonce:apkmody.nonce_remove_wishlist},function(data){if(data){added_wishlist.style.display='none';add_wishlist.style.display='block';}});});}
const textarea=document.getElementById('comment');if(textarea){textarea.addEventListener('click',function(){document.querySelector('.form-submit').style.opacity='1';document.querySelector('.form-submit').style.height='40px';document.querySelector('.comment-reply-title').style.opacity='1';document.querySelector('.comment-reply-title').style.height='40px';});textarea.addEventListener('input',function(){document.querySelector('.form-submit').style.opacity='1';document.querySelector('.form-submit').style.height='40px';document.querySelector('.comment-reply-title').style.opacity='1';document.querySelector('.comment-reply-title').style.height='40px';});textarea.addEventListener('keydown',function(){setTimeout(function(){textarea.style.height='auto';textarea.style.height=textarea.scrollHeight+'px';},0);});}
let load_more_comment=document.getElementById('load-more-comment');if(load_more_comment){const append_element=document.querySelector('.wp-block-latest-comments');const max_page=1;load_more_comment.addEventListener('click',function(){let page=Number(load_more_comment.dataset.page);ajax({action:'load_more',object:'comments',post_id:apkmody.post_id,page:page,_wpnonce:apkmody.nonce_load_comments,},function(response){if(response){append_element.innerHTML=append_element.innerHTML+response;if(page>max_page){load_more_comment.dataset.page=page-1;}else if(page<max_page){load_more_comment.dataset.page=page+1;}
if(load_element.dataset.page==max_page){load_more_comment.style.display='none';}}});});}
let load_more_search=document.getElementById('load-more-search');if(load_more_search){const append_element=document.querySelector('.flex-container');const max_page=20;load_more_search.addEventListener('click',function(){let page=Number(load_more_search.dataset.page);ajax({action:'load_more',object:'search',query:apkmody.search_query,page:page,lang:apkmody.lang},function(response){if(response){append_element.innerHTML=append_element.innerHTML+response;if(page>max_page){load_more_search.dataset.page=page-1;}else if(page<max_page){load_more_search.dataset.page=page+1;}
if(load_element.dataset.page>=max_page){load_more_search.style.display='none';}}});});}});